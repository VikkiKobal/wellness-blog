---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
---

<Layout title="Contact | Antonina Devitska" description="Get in touch with Antonina Devitska.">
  <Header currentPage="contact" />

  <main class="contact-page">
    <section class="contact-hero">
      <div class="container">
        <h1 class="hero-title">Let's Connect</h1>
        <p class="subtitle">
          Want to collaborate, invite me to speak, or ask a question? Send a message and I'll get back to you soon.
        </p>
      </div>
    </section>

    <section class="contact-content">
      <div class="container">
        <div class="grid">
          <div class="info-sidebar">
            <div class="info-card">
              <div class="icon-wrapper">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M3 8L10.89 13.26C11.2187 13.4793 11.6049 13.5963 12 13.5963C12.3951 13.5963 12.7813 13.4793 13.11 13.26L21 8M5 19H19C19.5304 19 20.0391 18.7893 20.4142 18.4142C20.7893 18.0391 21 17.5304 21 17V7C21 6.46957 20.7893 5.96086 20.4142 5.58579C20.0391 5.21071 19.5304 5 19 5H5C4.46957 5 3.96086 5.21071 3.58579 5.58579C3.21071 5.96086 3 6.46957 3 7V17C3 17.5304 3.21071 18.0391 3.58579 18.4142C3.96086 18.7893 4.46957 19 5 19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
              <h3>Email</h3>
              <a href="mailto:devitska.education@gmail.com" class="contact-link">devitska.education@gmail.com</a>
            </div>

            <div class="info-card">
              <div class="icon-wrapper">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M22 16.92V20a2 2 0 0 1-2.18 2A19.86 19.86 0 0 1 3 5.18 2 2 0 0 1 5 3h3.09a2 2 0 0 1 2 1.72c.12.86.3 1.7.54 2.5a2 2 0 0 1-.45 2.11L9.09 10.91a16 16 0 0 0 4 4l1.58-1.09a2 2 0 0 1 2.11-.45c.8.24 1.64.42 2.5.54A2 2 0 0 1 22 16.92Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
              <h3>Phone</h3>
              <a href="tel:+380951416008" class="contact-link">+38 095 141 60 08</a>
            </div>

            <div class="info-card">
              <div class="icon-wrapper">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M17 21V19C17 17.9391 16.5786 16.9217 15.8284 16.1716C15.0783 15.4214 14.0609 15 13 15H5C3.93913 15 2.92172 15.4214 2.17157 16.1716C1.42143 16.9217 1 17.9391 1 19V21M23 21V19C22.9993 18.1137 22.7044 17.2528 22.1614 16.5523C21.6184 15.8519 20.8581 15.3516 20 15.13M16 3.13C16.8604 3.3503 17.623 3.8507 18.1676 4.55231C18.7122 5.25392 19.0078 6.11683 19.0078 7.005C19.0078 7.89317 18.7122 8.75608 18.1676 9.45769C17.623 10.1593 16.8604 10.6597 16 10.88M13 7C13 9.20914 11.2091 11 9 11C6.79086 11 5 9.20914 5 7C5 4.79086 6.79086 3 9 3C11.2091 3 13 4.79086 13 7Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
              <h3>Follow Me</h3>
              <div class="social-links">
                <a href="https://www.facebook.com/HorvatErikAntonina?mibextid=LQQJ4d&rdid=rQsXyuheqZRclwvF&share_url=https%3A%2F%2Fwww.facebook.com%2Fshare%2F18uuFgH722%2F%3Fmibextid%3DLQQJ4d%23" target="_blank" rel="noopener" aria-label="Facebook" class="social-btn">
                  <svg width="10" height="18" viewBox="0 0 10 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M6.39703 17.9978V9.80078H9.16203L9.57303 6.59178H6.39703V4.54778C6.39703 3.62178 6.65503 2.98778 7.98403 2.98778H9.66803V0.126781C8.84903 0.0387813 8.02503 -0.00421875 7.20103 0.000781254C4.75703 0.000781254 3.07903 1.49178 3.07903 4.23078V6.58578H0.332031V9.79478H3.08503V17.9978H6.39703Z" fill="currentColor"/>
                  </svg>
                </a>
                <a href="https://www.linkedin.com/in/antonina-devitska-199017266/" target="_blank" rel="noopener" aria-label="LinkedIn" class="social-btn">
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3.58065 16H0.264516V5.31742H3.58065V16ZM1.92097 3.86H1.9C0.754839 3.86 0 3.07097 0 2.08387C0 1.07613 0.776774 0.30968 1.94258 0.30968C3.10839 0.30968 3.84129 1.07613 3.86323 2.08387C3.86323 3.07097 3.10839 3.86 1.92097 3.86ZM16 16H12.6839V10.3277C12.6839 8.99355 12.2097 8.08387 11.0006 8.08387C10.0684 8.08387 9.51226 8.7029 9.27097 9.30129C9.18581 9.50645 9.16387 9.78839 9.16387 10.0716V16H5.84774C5.84774 16 5.89161 6.65548 5.84774 5.31742H9.16387V6.72516C9.60258 6.05935 10.38 5.11097 12.1877 5.11097C14.4335 5.11097 16 6.47742 16 9.91355V16Z" fill="currentColor"/>
                  </svg>
                </a>
                <a href="https://www.researchgate.net/profile/Antonina-Devitska?ev=hdr_xprf" target="_blank" rel="noopener" aria-label="ResearchGate" class="social-btn rg-btn">
                  <span class="rg-text">R<sup>G</sup></span>
                </a>
              </div>
            </div>
          </div>

          <div class="form">
            <form id="contact-form" class="form-card" novalidate>
              <h2 class="card-title">Send a message</h2>

              <div class="row">
                <label class="field">
                  <span class="label">Name</span>
                  <input name="name" type="text" autocomplete="name" required minlength="2" placeholder="Your name" />
                </label>

                <label class="field">
                  <span class="label">Email</span>
                  <input name="email" type="email" autocomplete="email" required placeholder="you@example.com" />
                </label>
              </div>

              <label class="field">
                <span class="label">Subject <span class="muted">(optional)</span></span>
                <input name="subject" type="text" maxlength="140" placeholder="Whatâ€™s this about?" />
              </label>

              <label class="field">
                <span class="label">Message</span>
                <textarea name="message" rows="7" required minlength="10" maxlength="5000" placeholder="Write your message..."></textarea>
              </label>

              <!-- Honeypot field (hidden): bots will fill this -->
              <label class="honeypot" aria-hidden="true">
                Website
                <input name="website" type="text" tabindex="-1" autocomplete="off" />
              </label>

              <input name="createdAt" type="hidden" value="" />

              <div class="actions">
                <button id="contact-submit" class="btn-primary" type="submit">
                  <span class="btn-text">Send message</span>
                  <span class="btn-spinner" aria-hidden="true"></span>
                </button>
                <p id="contact-status" class="status" aria-live="polite"></p>
              </div>

              <p class="fineprint">
                By sending this form you agree to be contacted back at the email you provide.
              </p>
            </form>
          </div>
        </div>
      </div>
    </section>
  </main>

  <Footer />
</Layout>

<style>
  .contact-page {
    padding-top: 120px; 
  }

  .contact-hero {
    padding: 40px 0 32px;
    text-align: center;
  }

  .hero-title {
    font-family: var(--font-primary);
    font-weight: 700;
    font-size: 48px;
    line-height: 1.1;
    color: var(--color-text-black);
    margin-bottom: 16px;
  }

  .subtitle {
    max-width: 60ch;
    margin: 0 auto;
    font-size: 18px;
    line-height: 1.6;
    color: var(--color-text-dark);
  }

  .contact-content {
    padding: 32px 0 80px;
  }

  .grid {
    display: grid;
    grid-template-columns: 380px 1fr;
    gap: 32px;
    align-items: start;
  }

  .info-sidebar {
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  .info-card {
    background: var(--color-white);
    border: 1px solid rgba(141, 119, 171, 0.2);
    border-radius: 16px;
    padding: 24px;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }

  .info-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 20px rgba(141, 119, 171, 0.12);
  }

  .icon-wrapper {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 48px;
    height: 48px;
    background: var(--gradient-cta);
    border-radius: 12px;
    color: var(--color-white);
    margin-bottom: 16px;
  }

  .info-card h3 {
    font-family: var(--font-primary);
    font-weight: 600;
    font-size: 18px;
    color: var(--color-text-black);
    margin-bottom: 8px;
  }

  .contact-link {
    display: inline-block;
    font-size: 15px;
    color: var(--color-primary);
    text-decoration: none;
    font-weight: 500;
    transition: color 0.2s ease;
  }

  .contact-link:hover {
    color: var(--color-primary-dark);
    text-decoration: underline;
  }

  .info-text {
    font-size: 15px;
    color: var(--color-text-dark);
    line-height: 1.5;
  }

  .social-links {
    display: flex;
    gap: 12px;
    margin-top: 4px;
  }

  .social-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    background: var(--color-white);
    border-radius: 50%;
    color: var(--color-primary);
    transition: all 0.3s ease;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  .social-btn:hover {
    background: var(--color-primary);
    color: var(--color-white);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }

  .rg-btn {
    font-family: var(--font-primary);
    font-weight: 700;
    text-decoration: none;
  }

  .rg-text {
    font-size: 12px;
    color: var(--color-primary);
    transition: color 0.3s ease;
  }

  .social-btn:hover .rg-text {
    color: var(--color-white);
  }

  .rg-text sup {
    font-size: 8px;
    vertical-align: super;
  }

  .card-title {
    font-family: var(--font-primary);
    font-weight: 700;
    font-size: 24px;
    margin-bottom: 8px;
  }

  .form-card {
    background: var(--color-green-bg);
    border: 1px solid var(--color-primary);
    border-radius: 20px;
    padding: 24px;
    box-shadow: 0 2px 20px rgba(0, 0, 0, 0.05);
  }

  .row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 14px;
  }

  .field {
    display: grid;
    gap: 8px;
    margin-top: 14px;
  }

  .label {
    font-size: 14px;
    font-weight: 600;
    color: var(--color-text-dark);
  }

  .muted {
    font-weight: 500;
    color: var(--color-gray);
  }

  input,
  textarea {
    width: 100%;
    border: 1px solid rgba(1, 22, 44, 0.12);
    background: var(--color-white);
    border-radius: 14px;
    padding: 12px 14px;
    font-size: 16px;
    color: var(--color-text-dark);
    outline: none;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
  }

  textarea {
    resize: vertical;
    min-height: 150px;
  }

  input:focus,
  textarea:focus {
    border-color: rgba(141, 119, 171, 0.8);
    box-shadow: 0 0 0 4px rgba(141, 119, 171, 0.18);
  }

  .honeypot {
    position: absolute;
    left: -9999px;
    width: 1px;
    height: 1px;
    overflow: hidden;
  }

  .actions {
    display: flex;
    align-items: center;
    gap: 14px;
    margin-top: 18px;
  }

  .btn-primary {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    padding: 12px 18px;
    border-radius: 16px;
    background: var(--color-primary);
    color: var(--color-white);
    font-weight: 700;
    font-size: 16px;
    transition: transform 0.2s ease, background 0.2s ease, opacity 0.2s ease;
  }

  .btn-primary:hover {
    background: var(--color-primary-dark);
    transform: translateY(-1px);
  }

  .btn-primary:disabled {
    opacity: 0.75;
    transform: none;
    cursor: not-allowed;
  }

  .btn-spinner {
    display: none;
    width: 14px;
    height: 14px;
    border-radius: 999px;
    border: 2px solid rgba(255, 255, 255, 0.4);
    border-top-color: rgba(255, 255, 255, 1);
    animation: spin 0.8s linear infinite;
  }

  .btn-primary.is-loading .btn-spinner {
    display: inline-block;
  }

  .status {
    font-size: 14px;
    color: var(--color-text-dark);
  }

  .status.error {
    color: #b00020;
  }

  .status.success {
    color: #0b6b2e;
  }

  .fineprint {
    margin-top: 12px;
    font-size: 12px;
    color: var(--color-gray);
  }

  @keyframes spin {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }

  @media (max-width: 968px) {
    .grid {
      grid-template-columns: 1fr;
    }

    .info-sidebar {
      order: 2;
      margin-top: 24px;
    }

    .form {
      order: 1;
    }
  }

  @media (max-width: 768px) {
    .contact-page {
      padding-top: 96px;
    }

    .hero-title {
      font-size: 36px;
    }

    .subtitle {
      font-size: 16px;
    }

    .contact-hero {
      padding: 24px 0 24px;
    }

    .contact-content {
      padding: 24px 0 60px;
    }

    .row {
      grid-template-columns: 1fr;
    }

    .info-card {
      padding: 20px;
    }

    .icon-wrapper {
      width: 44px;
      height: 44px;
    }
  }
</style>

<script type="module">
  const API_BASE_URL = import.meta.env.PUBLIC_API_URL || 'http://localhost:8080/api';

  const form = document.getElementById('contact-form');
  const submitBtn = document.getElementById('contact-submit');
  const statusEl = document.getElementById('contact-status');

  function setStatus(text, kind) {
    if (!statusEl) return;
    statusEl.textContent = text || '';
    statusEl.classList.toggle('error', kind === 'error');
    statusEl.classList.toggle('success', kind === 'success');
  }

  function setLoading(loading) {
    if (!submitBtn) return;
    submitBtn.toggleAttribute('disabled', loading);
    submitBtn.classList.toggle('is-loading', loading);
  }

  // timestamp used for a basic bot/timing check
  const createdAtInput = form?.querySelector('input[name="createdAt"]');
  if (createdAtInput) createdAtInput.value = String(Date.now());

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();
    setStatus('', '');

    const fd = new FormData(form);
    const payload = {
      name: String(fd.get('name') || '').trim(),
      email: String(fd.get('email') || '').trim(),
      subject: String(fd.get('subject') || '').trim(),
      message: String(fd.get('message') || '').trim(),
      website: String(fd.get('website') || '').trim(),
      createdAt: Number(fd.get('createdAt') || 0),
    };

    // Basic client-side validation (server also validates)
    if (payload.name.length < 2) return setStatus('Please enter your name.', 'error');
    if (!payload.email.includes('@')) return setStatus('Please enter a valid email.', 'error');
    if (payload.message.length < 10) return setStatus('Please enter a message (at least 10 characters).', 'error');

    setLoading(true);
    try {
      const res = await fetch(`${API_BASE_URL}/contact`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload),
      });

      const data = await res.json().catch(() => null);
      if (!res.ok || !data?.success) {
        setStatus(data?.message || 'Failed to send. Please try again.', 'error');
        return;
      }

      setStatus(data.message || 'Message sent! Thank you.', 'success');
      form.reset();
      if (createdAtInput) createdAtInput.value = String(Date.now());
    } catch (err) {
      setStatus('Network error. Please try again.', 'error');
    } finally {
      setLoading(false);
    }
  });
</script>


