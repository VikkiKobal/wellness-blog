---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
---

<Layout title="Contact | Antonina Devitska" description="Get in touch with Antonina Devitska.">
  <Header currentPage="contact" />

  <main class="contact-page">
    <section class="contact-hero">
      <div class="container">
        <h1 class="hero-title">Let's Connect</h1>
        <p class="subtitle">
          Want to collaborate, invite me to speak, or ask a question? Send a message and I'll get back to you soon.
        </p>
      </div>
    </section>

    <section class="contact-content">
      <div class="container">
        <div class="grid">
          <div class="info-sidebar">
            <div class="info-card">
              <div class="icon-wrapper">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M3 8L10.89 13.26C11.2187 13.4793 11.6049 13.5963 12 13.5963C12.3951 13.5963 12.7813 13.4793 13.11 13.26L21 8M5 19H19C19.5304 19 20.0391 18.7893 20.4142 18.4142C20.7893 18.0391 21 17.5304 21 17V7C21 6.46957 20.7893 5.96086 20.4142 5.58579C20.0391 5.21071 19.5304 5 19 5H5C4.46957 5 3.96086 5.21071 3.58579 5.58579C3.21071 5.96086 3 6.46957 3 7V17C3 17.5304 3.21071 18.0391 3.58579 18.4142C3.96086 18.7893 4.46957 19 5 19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
              <h3>Email</h3>
              <a href="mailto:antonina.devitska@example.com" class="contact-link">antonina.devitska@example.com</a>
            </div>

            <div class="info-card">
              <div class="icon-wrapper">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M12 21C16.9706 21 21 16.9706 21 12C21 7.02944 16.9706 3 12 3C7.02944 3 3 7.02944 3 12C3 16.9706 7.02944 21 12 21Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M12 6V12L16 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
              <h3>Response Time</h3>
              <p class="info-text">I typically respond within 24-48 hours</p>
            </div>

            <div class="info-card">
              <div class="icon-wrapper">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M17 21V19C17 17.9391 16.5786 16.9217 15.8284 16.1716C15.0783 15.4214 14.0609 15 13 15H5C3.93913 15 2.92172 15.4214 2.17157 16.1716C1.42143 16.9217 1 17.9391 1 19V21M23 21V19C22.9993 18.1137 22.7044 17.2528 22.1614 16.5523C21.6184 15.8519 20.8581 15.3516 20 15.13M16 3.13C16.8604 3.3503 17.623 3.8507 18.1676 4.55231C18.7122 5.25392 19.0078 6.11683 19.0078 7.005C19.0078 7.89317 18.7122 8.75608 18.1676 9.45769C17.623 10.1593 16.8604 10.6597 16 10.88M13 7C13 9.20914 11.2091 11 9 11C6.79086 11 5 9.20914 5 7C5 4.79086 6.79086 3 9 3C11.2091 3 13 4.79086 13 7Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
              <h3>Connect</h3>
              <div class="social-links">
                <a href="https://www.facebook.com/HorvatErikAntonina?mibextid=LQQJ4d&rdid=rQsXyuheqZRclwvF&share_url=https%3A%2F%2Fwww.facebook.com%2Fshare%2F18uuFgH722%2F%3Fmibextid%3DLQQJ4d%23" target="_blank" rel="noopener" aria-label="Facebook" class="social-btn">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                  </svg>
                </a>
                <a href="https://www.linkedin.com/in/antonina-devitska-199017266/" target="_blank" rel="noopener" aria-label="LinkedIn" class="social-btn">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                  </svg>
                </a>
              </div>
            </div>
          </div>

          <div class="form">
            <form id="contact-form" class="form-card" novalidate>
              <h2 class="card-title">Send a message</h2>

              <div class="row">
                <label class="field">
                  <span class="label">Name</span>
                  <input name="name" type="text" autocomplete="name" required minlength="2" placeholder="Your name" />
                </label>

                <label class="field">
                  <span class="label">Email</span>
                  <input name="email" type="email" autocomplete="email" required placeholder="you@example.com" />
                </label>
              </div>

              <label class="field">
                <span class="label">Subject <span class="muted">(optional)</span></span>
                <input name="subject" type="text" maxlength="140" placeholder="Whatâ€™s this about?" />
              </label>

              <label class="field">
                <span class="label">Message</span>
                <textarea name="message" rows="7" required minlength="10" maxlength="5000" placeholder="Write your message..."></textarea>
              </label>

              <!-- Honeypot field (hidden): bots will fill this -->
              <label class="honeypot" aria-hidden="true">
                Website
                <input name="website" type="text" tabindex="-1" autocomplete="off" />
              </label>

              <input name="createdAt" type="hidden" value="" />

              <div class="actions">
                <button id="contact-submit" class="btn-primary" type="submit">
                  <span class="btn-text">Send message</span>
                  <span class="btn-spinner" aria-hidden="true"></span>
                </button>
                <p id="contact-status" class="status" aria-live="polite"></p>
              </div>

              <p class="fineprint">
                By sending this form you agree to be contacted back at the email you provide.
              </p>
            </form>
          </div>
        </div>
      </div>
    </section>
  </main>

  <Footer />
</Layout>

<style>
  .contact-page {
    padding-top: 120px; 
  }

  .contact-hero {
    padding: 40px 0 32px;
    text-align: center;
  }

  .hero-title {
    font-family: var(--font-primary);
    font-weight: 700;
    font-size: 48px;
    line-height: 1.1;
    color: var(--color-text-black);
    margin-bottom: 16px;
  }

  .subtitle {
    max-width: 60ch;
    margin: 0 auto;
    font-size: 18px;
    line-height: 1.6;
    color: var(--color-text-dark);
  }

  .contact-content {
    padding: 32px 0 80px;
  }

  .grid {
    display: grid;
    grid-template-columns: 380px 1fr;
    gap: 32px;
    align-items: start;
  }

  .info-sidebar {
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  .info-card {
    background: var(--color-white);
    border: 1px solid rgba(141, 119, 171, 0.2);
    border-radius: 16px;
    padding: 24px;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }

  .info-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 20px rgba(141, 119, 171, 0.12);
  }

  .icon-wrapper {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 48px;
    height: 48px;
    background: var(--gradient-cta);
    border-radius: 12px;
    color: var(--color-white);
    margin-bottom: 16px;
  }

  .info-card h3 {
    font-family: var(--font-primary);
    font-weight: 600;
    font-size: 18px;
    color: var(--color-text-black);
    margin-bottom: 8px;
  }

  .contact-link {
    display: inline-block;
    font-size: 15px;
    color: var(--color-primary);
    text-decoration: none;
    font-weight: 500;
    transition: color 0.2s ease;
  }

  .contact-link:hover {
    color: var(--color-primary-dark);
    text-decoration: underline;
  }

  .info-text {
    font-size: 15px;
    color: var(--color-text-dark);
    line-height: 1.5;
  }

  .social-links {
    display: flex;
    gap: 12px;
    margin-top: 4px;
  }

  .social-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: var(--color-green-bg);
    border-radius: 10px;
    color: var(--color-primary);
    transition: all 0.2s ease;
  }

  .social-btn:hover {
    background: var(--color-primary);
    color: var(--color-white);
    transform: translateY(-2px);
  }

  .card-title {
    font-family: var(--font-primary);
    font-weight: 700;
    font-size: 24px;
    margin-bottom: 8px;
  }

  .form-card {
    background: var(--color-green-bg);
    border: 1px solid var(--color-primary);
    border-radius: 20px;
    padding: 24px;
    box-shadow: 0 2px 20px rgba(0, 0, 0, 0.05);
  }

  .row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 14px;
  }

  .field {
    display: grid;
    gap: 8px;
    margin-top: 14px;
  }

  .label {
    font-size: 14px;
    font-weight: 600;
    color: var(--color-text-dark);
  }

  .muted {
    font-weight: 500;
    color: var(--color-gray);
  }

  input,
  textarea {
    width: 100%;
    border: 1px solid rgba(1, 22, 44, 0.12);
    background: var(--color-white);
    border-radius: 14px;
    padding: 12px 14px;
    font-size: 16px;
    color: var(--color-text-dark);
    outline: none;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
  }

  textarea {
    resize: vertical;
    min-height: 150px;
  }

  input:focus,
  textarea:focus {
    border-color: rgba(141, 119, 171, 0.8);
    box-shadow: 0 0 0 4px rgba(141, 119, 171, 0.18);
  }

  .honeypot {
    position: absolute;
    left: -9999px;
    width: 1px;
    height: 1px;
    overflow: hidden;
  }

  .actions {
    display: flex;
    align-items: center;
    gap: 14px;
    margin-top: 18px;
  }

  .btn-primary {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    padding: 12px 18px;
    border-radius: 16px;
    background: var(--color-primary);
    color: var(--color-white);
    font-weight: 700;
    font-size: 16px;
    transition: transform 0.2s ease, background 0.2s ease, opacity 0.2s ease;
  }

  .btn-primary:hover {
    background: var(--color-primary-dark);
    transform: translateY(-1px);
  }

  .btn-primary:disabled {
    opacity: 0.75;
    transform: none;
    cursor: not-allowed;
  }

  .btn-spinner {
    display: none;
    width: 14px;
    height: 14px;
    border-radius: 999px;
    border: 2px solid rgba(255, 255, 255, 0.4);
    border-top-color: rgba(255, 255, 255, 1);
    animation: spin 0.8s linear infinite;
  }

  .btn-primary.is-loading .btn-spinner {
    display: inline-block;
  }

  .status {
    font-size: 14px;
    color: var(--color-text-dark);
  }

  .status.error {
    color: #b00020;
  }

  .status.success {
    color: #0b6b2e;
  }

  .fineprint {
    margin-top: 12px;
    font-size: 12px;
    color: var(--color-gray);
  }

  @keyframes spin {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }

  @media (max-width: 968px) {
    .grid {
      grid-template-columns: 1fr;
    }

    .info-sidebar {
      order: 2;
      margin-top: 24px;
    }

    .form {
      order: 1;
    }
  }

  @media (max-width: 768px) {
    .contact-page {
      padding-top: 96px;
    }

    .hero-title {
      font-size: 36px;
    }

    .subtitle {
      font-size: 16px;
    }

    .contact-hero {
      padding: 24px 0 24px;
    }

    .contact-content {
      padding: 24px 0 60px;
    }

    .row {
      grid-template-columns: 1fr;
    }

    .info-card {
      padding: 20px;
    }

    .icon-wrapper {
      width: 44px;
      height: 44px;
    }
  }
</style>

<script type="module">
  const API_BASE_URL = import.meta.env.PUBLIC_API_URL || 'http://localhost:8080/api';

  const form = document.getElementById('contact-form');
  const submitBtn = document.getElementById('contact-submit');
  const statusEl = document.getElementById('contact-status');

  function setStatus(text, kind) {
    if (!statusEl) return;
    statusEl.textContent = text || '';
    statusEl.classList.toggle('error', kind === 'error');
    statusEl.classList.toggle('success', kind === 'success');
  }

  function setLoading(loading) {
    if (!submitBtn) return;
    submitBtn.toggleAttribute('disabled', loading);
    submitBtn.classList.toggle('is-loading', loading);
  }

  // timestamp used for a basic bot/timing check
  const createdAtInput = form?.querySelector('input[name="createdAt"]');
  if (createdAtInput) createdAtInput.value = String(Date.now());

  form?.addEventListener('submit', async (e) => {
    e.preventDefault();
    setStatus('', '');

    const fd = new FormData(form);
    const payload = {
      name: String(fd.get('name') || '').trim(),
      email: String(fd.get('email') || '').trim(),
      subject: String(fd.get('subject') || '').trim(),
      message: String(fd.get('message') || '').trim(),
      website: String(fd.get('website') || '').trim(),
      createdAt: Number(fd.get('createdAt') || 0),
    };

    // Basic client-side validation (server also validates)
    if (payload.name.length < 2) return setStatus('Please enter your name.', 'error');
    if (!payload.email.includes('@')) return setStatus('Please enter a valid email.', 'error');
    if (payload.message.length < 10) return setStatus('Please enter a message (at least 10 characters).', 'error');

    setLoading(true);
    try {
      const res = await fetch(`${API_BASE_URL}/contact`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload),
      });

      const data = await res.json().catch(() => null);
      if (!res.ok || !data?.success) {
        setStatus(data?.message || 'Failed to send. Please try again.', 'error');
        return;
      }

      setStatus(data.message || 'Message sent! Thank you.', 'success');
      form.reset();
      if (createdAtInput) createdAtInput.value = String(Date.now());
    } catch (err) {
      setStatus('Network error. Please try again.', 'error');
    } finally {
      setLoading(false);
    }
  });
</script>


