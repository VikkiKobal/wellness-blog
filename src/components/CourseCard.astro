---
interface Props {
  id: string;
  title: string;
  image: string;
  description?: string;
  lessons?: string;
  duration?: string;
  enrollLink?: string;
  tags?: string[];
  buttonText?: string;
}

const { 
  id,
  title, 
  image,
  description = "Learn how to use reflection for personal and professional growth, analyze experiences, and improve decision-making skills.",
  lessons = "12 Lessons", 
  duration = "4 Weeks",
  enrollLink = "",
  tags = ["students", "professionals", "anyone seeking self-improvement"],
  buttonText = "Enroll",
} = Astro.props;

// Create JSON data for the modal
const courseData = JSON.stringify({
  title,
  description,
  image,
  enrollLink,
  tags
});
---

<article class="course-card" data-course-id={id} data-course={courseData}>
  <div class="course-image">
    <img src={image} alt={title} />
  </div>
  <div class="course-content">
    <h3 class="course-title">{title}</h3>
    <div class="course-meta">
      <span class="meta-item">
        <svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M7.5 1.875C4.39453 1.875 1.875 4.39453 1.875 7.5C1.875 10.6055 4.39453 13.125 7.5 13.125C10.6055 13.125 13.125 10.6055 13.125 7.5C13.125 4.39453 10.6055 1.875 7.5 1.875ZM7.5 12.1875C4.91016 12.1875 2.8125 10.0898 2.8125 7.5C2.8125 4.91016 4.91016 2.8125 7.5 2.8125C10.0898 2.8125 12.1875 4.91016 12.1875 7.5C12.1875 10.0898 10.0898 12.1875 7.5 12.1875Z" fill="currentColor"/>
          <path d="M9.84375 7.03125H7.96875V4.6875C7.96875 4.42969 7.75781 4.21875 7.5 4.21875C7.24219 4.21875 7.03125 4.42969 7.03125 4.6875V7.5C7.03125 7.75781 7.24219 7.96875 7.5 7.96875H9.84375C10.1016 7.96875 10.3125 7.75781 10.3125 7.5C10.3125 7.24219 10.1016 7.03125 9.84375 7.03125Z" fill="currentColor"/>
        </svg>
        {lessons}
      </span>
      <span class="meta-item">
        <svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12.1875 2.8125H11.25V2.34375C11.25 2.08594 11.0391 1.875 10.7812 1.875C10.5234 1.875 10.3125 2.08594 10.3125 2.34375V2.8125H4.6875V2.34375C4.6875 2.08594 4.47656 1.875 4.21875 1.875C3.96094 1.875 3.75 2.08594 3.75 2.34375V2.8125H2.8125C2.29688 2.8125 1.875 3.23438 1.875 3.75V12.1875C1.875 12.7031 2.29688 13.125 2.8125 13.125H12.1875C12.7031 13.125 13.125 12.7031 13.125 12.1875V3.75C13.125 3.23438 12.7031 2.8125 12.1875 2.8125ZM12.1875 12.1875H2.8125V5.625H12.1875V12.1875ZM12.1875 4.6875H2.8125V3.75H3.75V4.21875C3.75 4.47656 3.96094 4.6875 4.21875 4.6875C4.47656 4.6875 4.6875 4.47656 4.6875 4.21875V3.75H10.3125V4.21875C10.3125 4.47656 10.5234 4.6875 10.7812 4.6875C11.0391 4.6875 11.25 4.47656 11.25 4.21875V3.75H12.1875V4.6875Z" fill="currentColor"/>
        </svg>
        {duration}
      </span>
    </div>
    {enrollLink ? (
      <a href={enrollLink} target="_blank" class="course-btn" onclick="event.stopPropagation();">
        {buttonText}
      </a>
    ) : (
      <button type="button" class="course-btn">
        {buttonText}
      </button>
    )}
  </div>
</article>

<style>
  .course-card {
    background: var(--color-background);
    border: 1px solid var(--color-primary);
    border-radius: 16px;
    overflow: hidden;
    box-shadow: inset 0 0 0 0 var(--color-primary);
    transition: all 0.3s ease;
    cursor: pointer;
  }
  
  .course-card:hover {
    box-shadow: 0 8px 30px rgba(141, 119, 171, 0.15);
    transform: translateY(-4px);
  }
  
  .course-image {
    width: 100%;
    height: 214px;
    overflow: hidden;
  }
  
  .course-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 16px 16px 0 0;
    transition: transform 0.4s ease;
  }
  
  .course-card:hover .course-image img {
    transform: scale(1.05);
  }
  
  .course-content {
    padding: 24px;
    display: flex;
    flex-direction: column;
    gap: 16px;
  }
  
  .course-title {
    font-family: var(--font-primary);
    font-weight: 600;
    font-size: 16px;
    line-height: 1.69;
    color: var(--color-text-black);
    min-height: 54px;
  }
  
  .course-meta {
    display: flex;
    align-items: center;
    gap: 24px;
  }
  
  .meta-item {
    display: flex;
    align-items: center;
    gap: 6px;
    font-family: var(--font-primary);
    font-weight: 600;
    font-size: 14px;
    line-height: 1.93;
    color: var(--color-gray);
  }
  
  .meta-item svg {
    color: var(--color-gray);
  }
  
  .course-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 8px 24px;
    background: var(--color-primary);
    color: var(--color-white);
    border: none;
    border-radius: 8px;
    font-family: var(--font-primary);
    font-weight: 600;
    font-size: 16px;
    line-height: 1.69;
    transition: all 0.3s ease;
    align-self: flex-start;
    cursor: pointer;
  }
  
  .course-btn:hover {
    background: var(--color-primary-dark);
    transform: translateX(4px);
  }
  
  @media (max-width: 600px) {
    .course-image {
      height: 180px;
    }
    
    .course-content {
      padding: 20px;
    }
    
    .course-title {
      min-height: auto;
    }
    
    .course-meta {
      gap: 16px;
    }
    
    .meta-item {
      font-size: 12px;
    }
  }
</style>

<script>
  // Add click handlers to course cards
  document.querySelectorAll('.course-card').forEach(card => {
    card.addEventListener('click', () => {
      const courseDataStr = card.getAttribute('data-course');
      if (courseDataStr && (window as any).openCourseModal) {
        const courseData = JSON.parse(courseDataStr);
        (window as any).openCourseModal(courseData);
      }
    });
  });
</script>
